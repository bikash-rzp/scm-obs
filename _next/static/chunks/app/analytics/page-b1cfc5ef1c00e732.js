(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[745],{25411:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>J});var s=t(95155),r=t(12115),i=t(88482),n=t(31886),l=t(88145),o=t(83540),d=t(3401),c=t(94754),m=t(96025),x=t(16238),u=t(94517),h=t(83394),g=t(54811),j=t(36079),v=t(8782),f=t(34e3),y=t(24026),p=t(93504),b=t(21374),N=t(99445),w=t(62341);let S=e=>{let{message:a="Loading..."}=e;return(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center h-64",children:[(0,s.jsxs)("div",{className:"relative w-16 h-16 mb-4",children:[(0,s.jsx)("div",{className:"absolute inset-0 rounded-full bg-gradient-to-r from-primary-300 to-primary-600 animate-pulse"}),(0,s.jsx)("div",{className:"absolute inset-1 rounded-full bg-white"}),(0,s.jsx)("div",{className:"absolute inset-3 rounded-full bg-gradient-to-r from-primary-400 to-primary-700 animate-pulse"})]}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:a}),(0,s.jsxs)("div",{className:"w-full max-w-md mt-8",children:[(0,s.jsx)("div",{className:"h-3 w-1/2 bg-gradient-to-r from-gray-200 via-gray-300 to-gray-200 animate-pulse rounded mb-2"}),(0,s.jsx)("div",{className:"h-3 w-1/3 bg-gradient-to-r from-gray-200 via-gray-300 to-gray-200 animate-pulse rounded mb-4"}),(0,s.jsx)("div",{className:"h-32 w-full bg-gradient-to-r from-gray-200 via-gray-300 to-gray-200 animate-pulse rounded"})]})]})},A=()=>(0,s.jsxs)(i.Zp,{className:"col-span-3",children:[(0,s.jsxs)(i.aR,{children:[(0,s.jsx)("div",{className:"h-6 w-1/4 bg-gradient-to-r from-gray-200 via-gray-300 to-gray-200 animate-pulse rounded mb-2"}),(0,s.jsx)("div",{className:"h-4 w-2/5 bg-gradient-to-r from-gray-200 via-gray-300 to-gray-200 animate-pulse rounded"})]}),(0,s.jsx)(i.Wu,{children:(0,s.jsxs)("div",{className:"grid grid-cols-1 gap-6 sm:grid-cols-3",children:[(0,s.jsxs)("div",{className:"flex flex-col p-4 border rounded-lg",children:[(0,s.jsx)("div",{className:"h-3 w-3/4 bg-gradient-to-r from-gray-200 via-gray-300 to-gray-200 animate-pulse rounded mb-3"}),(0,s.jsx)("div",{className:"h-6 w-1/2 bg-gradient-to-r from-gray-200 via-gray-300 to-gray-200 animate-pulse rounded"})]}),(0,s.jsxs)("div",{className:"flex flex-col p-4 border rounded-lg",children:[(0,s.jsx)("div",{className:"h-3 w-3/4 bg-gradient-to-r from-gray-200 via-gray-300 to-gray-200 animate-pulse rounded mb-3"}),(0,s.jsx)("div",{className:"h-6 w-1/2 bg-gradient-to-r from-gray-200 via-gray-300 to-gray-200 animate-pulse rounded"})]}),(0,s.jsxs)("div",{className:"flex flex-col p-4 border rounded-lg",children:[(0,s.jsx)("div",{className:"h-3 w-3/4 bg-gradient-to-r from-gray-200 via-gray-300 to-gray-200 animate-pulse rounded mb-3"}),(0,s.jsx)("div",{className:"h-6 w-1/2 bg-gradient-to-r from-gray-200 via-gray-300 to-gray-200 animate-pulse rounded"})]})]})})]}),D=()=>(0,s.jsxs)(i.Zp,{children:[(0,s.jsxs)(i.aR,{children:[(0,s.jsx)("div",{className:"h-6 w-1/3 bg-gradient-to-r from-gray-200 via-gray-300 to-gray-200 animate-pulse rounded mb-2"}),(0,s.jsx)("div",{className:"h-4 w-2/5 bg-gradient-to-r from-gray-200 via-gray-300 to-gray-200 animate-pulse rounded"})]}),(0,s.jsx)(i.Wu,{children:(0,s.jsx)("div",{className:"h-[300px] bg-gradient-to-r from-gray-200 via-gray-300 to-gray-200 animate-pulse rounded"})})]}),T=e=>{let{data:a,loading:t}=e;if(t)return(0,s.jsx)(A,{});if(!a)return(0,s.jsxs)(i.Zp,{className:"col-span-3",children:[(0,s.jsxs)(i.aR,{children:[(0,s.jsx)(i.ZB,{children:"Summary"}),(0,s.jsx)(i.BT,{children:"No data available"})]}),(0,s.jsx)(i.Wu,{children:(0,s.jsx)("p",{children:"Summary data could not be loaded"})})]});let r=void 0!==a.total_devices?a.total_devices:a.totalDevices,n=void 0!==a.total_activities?a.total_activities:a.totalActivities,l=void 0!==a.avg_activities_per_device?a.avg_activities_per_device:a.avgActivitiesPerDevice;return void 0===l&&r&&n&&(l=n/r),(0,s.jsxs)(i.Zp,{className:"col-span-3",children:[(0,s.jsxs)(i.aR,{children:[(0,s.jsx)(i.ZB,{children:"Summary"}),(0,s.jsx)(i.BT,{children:"Key metrics and statistics"})]}),(0,s.jsx)(i.Wu,{children:(0,s.jsxs)("div",{className:"grid grid-cols-1 gap-6 sm:grid-cols-3",children:[(0,s.jsxs)("div",{className:"flex flex-col p-4 border rounded-lg",children:[(0,s.jsx)("span",{className:"text-sm text-muted-foreground",children:"Total Devices"}),(0,s.jsx)("span",{className:"text-2xl font-semibold",children:(null==r?void 0:r.toLocaleString())||0})]}),(0,s.jsxs)("div",{className:"flex flex-col p-4 border rounded-lg",children:[(0,s.jsx)("span",{className:"text-sm text-muted-foreground",children:"Total Activities"}),(0,s.jsx)("span",{className:"text-2xl font-semibold",children:(null==n?void 0:n.toLocaleString())||0})]}),(0,s.jsxs)("div",{className:"flex flex-col p-4 border rounded-lg",children:[(0,s.jsx)("span",{className:"text-sm text-muted-foreground",children:"Average Activities per Device"}),(0,s.jsx)("span",{className:"text-2xl font-semibold",children:(null==l?void 0:l.toFixed(1))||0})]})]})})]})},R=e=>{let{data:a,loading:t}=e;if(t)return(0,s.jsx)(D,{});let r=a?a.map(e=>({name:e.type||e.name||"",value:e.count||e.value||0})):[];console.log("Activity distribution chart data:",r);let n=["#8884d8"];return(0,s.jsxs)(i.Zp,{children:[(0,s.jsxs)(i.aR,{children:[(0,s.jsx)(i.ZB,{children:"Activity Distribution"}),(0,s.jsx)(i.BT,{children:"Distribution of different activity types"})]}),(0,s.jsx)(i.Wu,{children:(0,s.jsx)("div",{className:"h-[300px]",children:r.length>0?(0,s.jsx)(o.u,{width:"100%",height:"100%",children:(0,s.jsxs)(d.E,{data:r,margin:{top:20,right:30,left:20,bottom:80},children:[(0,s.jsx)(c.d,{strokeDasharray:"3 3",vertical:!1}),(0,s.jsx)(m.W,{dataKey:"name",angle:-45,textAnchor:"end",height:70,interval:0,tick:{fontSize:12}}),(0,s.jsx)(x.h,{}),(0,s.jsx)(u.m,{formatter:e=>[Number(e).toLocaleString(),"Count"]}),(0,s.jsxs)(h.y,{dataKey:"value",fill:"#8884d8",minPointSize:5,children:[r.map((e,a)=>(0,s.jsx)(g.f,{fill:n[a%n.length]},"cell-".concat(a))),(0,s.jsx)(j.Z,{dataKey:"value",position:"top",formatter:e=>e>0?e.toLocaleString():""})]})]})}):(0,s.jsx)("div",{className:"flex justify-center items-center h-full",children:(0,s.jsx)("p",{className:"text-muted-foreground",children:"No activity distribution data available"})})})})]})},E=e=>{let{data:a,loading:t}=e;if(t)return(0,s.jsx)(D,{});let r=["#2196F3","#4CAF50","#FF9800","#F44336","#9C27B0","#3F51B5","#00BCD4","#009688","#FFC107","#795548"],n=a?a.map(e=>({name:e.name||e.state||"Unknown",value:"number"==typeof e.value?e.value:"number"==typeof e.count?e.count:0})).filter(e=>e.value>0):[];return console.log("State distribution chart data:",n),n.sort((e,a)=>a.value-e.value),(0,s.jsxs)(i.Zp,{children:[(0,s.jsxs)(i.aR,{children:[(0,s.jsx)(i.ZB,{children:"Device State Distribution"}),(0,s.jsx)(i.BT,{children:"Current state of all devices"})]}),(0,s.jsx)(i.Wu,{children:(0,s.jsx)("div",{className:"h-[300px]",children:n.length>0?(0,s.jsx)(o.u,{width:"100%",height:"100%",children:(0,s.jsxs)(v.r,{children:[(0,s.jsx)(f.F,{data:n,cx:"50%",cy:"50%",outerRadius:100,innerRadius:0,fill:"#8884d8",dataKey:"value",nameKey:"name",labelLine:!0,label:e=>{let{name:a,percent:t}=e;return"".concat(a,": ").concat((100*t).toFixed(0),"%")},paddingAngle:2,children:n.map((e,a)=>(0,s.jsx)(g.f,{fill:r[a%r.length],stroke:"#fff",strokeWidth:1},"cell-".concat(a)))}),(0,s.jsx)(u.m,{formatter:(e,a)=>["".concat(Number(e).toLocaleString()," devices"),a],labelFormatter:e=>null}),(0,s.jsx)(y.s,{layout:"horizontal",verticalAlign:"bottom",align:"center",iconSize:10,iconType:"circle",wrapperStyle:{fontSize:"12px",paddingTop:"15px"}})]})}):(0,s.jsx)("div",{className:"flex justify-center items-center h-full",children:(0,s.jsx)("p",{className:"text-muted-foreground",children:"No distribution data available"})})})})]})},k=e=>{let{data:a,loading:t}=e;if(t)return(0,s.jsx)(D,{});console.log("Raw transitions data received:",a);let r=a?a.map(e=>{if(e.transition&&"number"==typeof e.count)return{name:e.transition,value:e.count,highlighted:e.highlighted||!1};if(!e.from||!e.to||"number"!=typeof e.count)return{name:e.name||"Unknown",value:e.value||0,highlighted:e.highlighted||!1};{let a=e.fromName||e.from,t=e.toName||e.to;return{name:"".concat(a," → ").concat(t),value:e.count,highlighted:e.highlighted||!1}}}):[];return console.log("State transitions chart processed data:",r),(0,s.jsxs)(i.Zp,{children:[(0,s.jsxs)(i.aR,{children:[(0,s.jsx)(i.ZB,{children:"State Transitions"}),(0,s.jsx)(i.BT,{children:"Most common state transitions"})]}),(0,s.jsx)(i.Wu,{children:(0,s.jsx)("div",{className:"h-[400px]",children:r.length>0?(0,s.jsx)(o.u,{width:"100%",height:"100%",children:(0,s.jsxs)(d.E,{data:r,layout:"vertical",margin:{top:5,right:30,left:150,bottom:5},children:[(0,s.jsx)(c.d,{strokeDasharray:"3 3",horizontal:!0,vertical:!1}),(0,s.jsx)(m.W,{type:"number"}),(0,s.jsx)(x.h,{dataKey:"name",type:"category",width:150,tick:e=>{let{x:a,y:t,payload:r}=e,i=r.value.split(" → ");return 2===i.length?(0,s.jsxs)("g",{transform:"translate(".concat(a,",").concat(t,")"),children:[(0,s.jsxs)("text",{x:-10,y:-5,dy:0,textAnchor:"end",fill:"#666",fontSize:11,transform:"rotate(-25)",children:[i[0]," →"]}),(0,s.jsx)("text",{x:-10,y:10,dy:0,textAnchor:"end",fill:"#666",fontSize:11,transform:"rotate(-25)",children:i[1]})]}):(0,s.jsx)("g",{transform:"translate(".concat(a,",").concat(t,")"),children:(0,s.jsx)("text",{x:-5,y:0,dy:4,textAnchor:"end",fill:"#666",fontSize:11,transform:"rotate(-35)",children:r.value})})}}),(0,s.jsx)(u.m,{formatter:e=>[Number(e).toLocaleString(),"Count"],labelFormatter:e=>"Transition: ".concat(e)}),(0,s.jsx)(h.y,{dataKey:"value",fill:"#4CAF50",children:r.map(e=>e.highlighted?(0,s.jsx)(g.f,{fill:"#9E9E9E"},e.name):(0,s.jsx)(g.f,{fill:"#4CAF50"},e.name))})]})}):(0,s.jsx)("div",{className:"flex justify-center items-center h-full",children:(0,s.jsx)("p",{className:"text-muted-foreground",children:"No transition data available"})})})})]})},B=e=>{let{data:a,loading:t}=e;if(t)return(0,s.jsx)(D,{});let r=a?a.map(e=>({date:e.date,count:void 0!==e.count?e.count:0})):[];return console.log("Activity timeline chart data:",r),(0,s.jsxs)(i.Zp,{children:[(0,s.jsxs)(i.aR,{children:[(0,s.jsx)(i.ZB,{children:"Activity Timeline"}),(0,s.jsx)(i.BT,{children:"Activity frequency over time"})]}),(0,s.jsx)(i.Wu,{children:(0,s.jsx)("div",{className:"h-[300px]",children:r.length>0?(0,s.jsx)(o.u,{width:"100%",height:"100%",children:(0,s.jsxs)(p.b,{data:r,margin:{top:20,right:30,left:20,bottom:30},children:[(0,s.jsx)(c.d,{strokeDasharray:"3 3",vertical:!1}),(0,s.jsx)(m.W,{dataKey:"date",angle:-20,textAnchor:"end",height:60,tick:{fontSize:10},interval:"preserveStartEnd"}),(0,s.jsx)(x.h,{}),(0,s.jsx)(u.m,{formatter:e=>[Number(e).toLocaleString(),"Count"]}),(0,s.jsx)(b.N,{type:"monotone",dataKey:"count",stroke:"#6C5CE7",dot:{fill:"#6C5CE7",r:3},activeDot:{r:5}})]})}):(0,s.jsx)("div",{className:"flex justify-center items-center h-full",children:(0,s.jsx)("p",{className:"text-muted-foreground",children:"No activity timeline data available"})})})})]})},Z=e=>{let{data:a,loading:t}=e;if(t)return(0,s.jsx)(D,{});let r=a?a.map(e=>({name:e.state||e.name||"",value:e.duration||e.average_days||0})):[];return console.log("State duration chart data:",r),(0,s.jsxs)(i.Zp,{children:[(0,s.jsxs)(i.aR,{children:[(0,s.jsx)(i.ZB,{children:"State Duration"}),(0,s.jsx)(i.BT,{children:"Average time spent in each state (days)"})]}),(0,s.jsx)(i.Wu,{children:(0,s.jsx)("div",{className:"h-[300px]",children:r.length>0?(0,s.jsx)(o.u,{width:"100%",height:"100%",children:(0,s.jsxs)(d.E,{data:r,margin:{top:20,right:30,left:20,bottom:80},children:[(0,s.jsx)(c.d,{strokeDasharray:"3 3",vertical:!1}),(0,s.jsx)(m.W,{dataKey:"name",angle:-45,textAnchor:"end",height:80,interval:0,tick:{fontSize:12}}),(0,s.jsx)(x.h,{label:{value:"Days",angle:-90,position:"insideLeft"}}),(0,s.jsx)(u.m,{formatter:e=>[Number(e).toFixed(1),"Days"]}),(0,s.jsx)(h.y,{dataKey:"value",fill:"#FF9800",minPointSize:5,children:(0,s.jsx)(j.Z,{dataKey:"value",position:"top",formatter:e=>e>0?e.toFixed(1):""})})]})}):(0,s.jsx)("div",{className:"flex justify-center items-center h-full",children:(0,s.jsx)("p",{className:"text-muted-foreground",children:"No state duration data available"})})})})]})},F=e=>{let{data:a,loading:t}=e;if(t)return(0,s.jsx)(D,{});let r=a?a.map(e=>({name:e.state||e.name||"",value:e.count||e.value||0})):[];return console.log("Activity frequency chart data:",r),(0,s.jsxs)(i.Zp,{children:[(0,s.jsxs)(i.aR,{children:[(0,s.jsx)(i.ZB,{children:"Activity Frequency by State"}),(0,s.jsx)(i.BT,{children:"Number of activities per state"})]}),(0,s.jsx)(i.Wu,{children:(0,s.jsx)("div",{className:"h-[300px]",children:r.length>0?(0,s.jsx)(o.u,{width:"100%",height:"100%",children:(0,s.jsxs)(d.E,{data:r,margin:{top:20,right:30,left:20,bottom:80},children:[(0,s.jsx)(c.d,{strokeDasharray:"3 3",vertical:!1}),(0,s.jsx)(m.W,{dataKey:"name",angle:-45,textAnchor:"end",height:80,interval:0,tick:{fontSize:12}}),(0,s.jsx)(x.h,{}),(0,s.jsx)(u.m,{formatter:e=>[Number(e).toLocaleString(),"Count"]}),(0,s.jsx)(h.y,{dataKey:"value",fill:"#FF5252",minPointSize:5,children:(0,s.jsx)(j.Z,{dataKey:"value",position:"top",formatter:e=>e>0?e.toLocaleString():""})})]})}):(0,s.jsx)("div",{className:"flex justify-center items-center h-full",children:(0,s.jsx)("p",{className:"text-muted-foreground",children:"No activity frequency data available"})})})})]})},L=()=>(0,s.jsxs)(i.Zp,{children:[(0,s.jsxs)(i.aR,{children:[(0,s.jsx)("div",{className:"h-6 w-1/3 bg-gradient-to-r from-gray-200 via-gray-300 to-gray-200 animate-pulse rounded mb-2"}),(0,s.jsx)("div",{className:"h-4 w-2/5 bg-gradient-to-r from-gray-200 via-gray-300 to-gray-200 animate-pulse rounded"})]}),(0,s.jsx)(i.Wu,{children:(0,s.jsxs)("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-3",children:[(0,s.jsxs)("div",{className:"flex flex-col p-3 border rounded-lg",children:[(0,s.jsx)("div",{className:"h-3 w-3/4 bg-gradient-to-r from-gray-200 via-gray-300 to-gray-200 animate-pulse rounded mb-3"}),(0,s.jsx)("div",{className:"h-6 w-1/2 bg-gradient-to-r from-gray-200 via-gray-300 to-gray-200 animate-pulse rounded"})]}),(0,s.jsxs)("div",{className:"flex flex-col p-3 border rounded-lg",children:[(0,s.jsx)("div",{className:"h-3 w-3/4 bg-gradient-to-r from-gray-200 via-gray-300 to-gray-200 animate-pulse rounded mb-3"}),(0,s.jsx)("div",{className:"h-6 w-1/2 bg-gradient-to-r from-gray-200 via-gray-300 to-gray-200 animate-pulse rounded"})]}),(0,s.jsxs)("div",{className:"flex flex-col p-3 border rounded-lg",children:[(0,s.jsx)("div",{className:"h-3 w-3/4 bg-gradient-to-r from-gray-200 via-gray-300 to-gray-200 animate-pulse rounded mb-3"}),(0,s.jsx)("div",{className:"h-6 w-1/2 bg-gradient-to-r from-gray-200 via-gray-300 to-gray-200 animate-pulse rounded"})]})]})})]}),C=e=>{var a,t,r,n,l,o,d;let{data:c,loading:m}=e;if(m)return(0,s.jsx)(L,{});if(!c)return(0,s.jsxs)(i.Zp,{children:[(0,s.jsxs)(i.aR,{children:[(0,s.jsx)(i.ZB,{children:"Anomaly Summary"}),(0,s.jsx)(i.BT,{children:"No data available"})]}),(0,s.jsx)(i.Wu,{children:(0,s.jsx)("p",{children:"Anomaly data could not be loaded"})})]});console.log("AnomalyStats received data:",c),null!=c.total_anomalous_devices||c.outlierDevices;let x=c.anomaly_counts_by_type||{},u=null!=(r=null!=(t=x.LOOP_DETECTED)?t:c.loopDetected)?r:0,h=null!=(l=null!=(n=x.EXCESSIVE_DWELL)?n:c.stuckDevices)?l:0,g=null!=(d=null!=(o=x.INVALID_TRANSITION)?o:c.invalidTransitions)?d:0;return(0,s.jsxs)(i.Zp,{children:[(0,s.jsxs)(i.aR,{children:[(0,s.jsx)(i.ZB,{children:"Anomaly Summary"}),(0,s.jsx)(i.BT,{children:"Overview of detected anomalies"})]}),(0,s.jsx)(i.Wu,{children:(0,s.jsxs)("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-3",children:[(0,s.jsxs)("div",{className:"flex flex-col p-3 border rounded-lg bg-amber-50",children:[(0,s.jsx)("span",{className:"text-sm text-muted-foreground",children:"Stuck Devices"}),(0,s.jsx)("span",{className:"text-2xl font-semibold",children:(null==h?void 0:h.toLocaleString())||0})]}),(0,s.jsxs)("div",{className:"flex flex-col p-3 border rounded-lg bg-blue-50",children:[(0,s.jsx)("span",{className:"text-sm text-muted-foreground",children:"Loop Detected"}),(0,s.jsx)("span",{className:"text-2xl font-semibold",children:(null==u?void 0:u.toLocaleString())||0})]}),(0,s.jsxs)("div",{className:"flex flex-col p-3 border rounded-lg bg-red-50",children:[(0,s.jsx)("span",{className:"text-sm text-muted-foreground",children:"Invalid Transitions"}),(0,s.jsx)("span",{className:"text-2xl font-semibold",children:(null==g?void 0:g.toLocaleString())||0})]})]})})]})},_=e=>{let{data:a,loading:t}=e;if(t)return(0,s.jsx)(S,{message:"Loading advanced metrics data..."});if(!a)return(0,s.jsxs)(i.Zp,{children:[(0,s.jsxs)(i.aR,{children:[(0,s.jsx)(i.ZB,{children:"Advanced Metrics"}),(0,s.jsx)(i.BT,{children:"No data available"})]}),(0,s.jsx)(i.Wu,{children:(0,s.jsx)("p",{children:"Advanced metrics could not be loaded"})})]});let{uniqueDevicesPerState:r={},avgTransitions:n=0}=a;return(0,s.jsxs)(i.Zp,{className:"col-span-full",children:[(0,s.jsxs)(i.aR,{children:[(0,s.jsx)(i.ZB,{children:"Advanced Metrics"}),(0,s.jsx)(i.BT,{children:"Additional device and state insights"})]}),(0,s.jsx)(i.Wu,{children:(0,s.jsxs)("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-2",children:[(0,s.jsxs)("div",{className:"border rounded-lg p-4",children:[(0,s.jsx)("h3",{className:"text-lg font-medium mb-4",children:"Unique Devices per State"}),(0,s.jsx)("div",{className:"space-y-2",children:Object.entries(r).map(e=>{let[a,t]=e;return(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsxs)("span",{children:[a,":"]}),(0,s.jsx)("span",{className:"font-medium",children:(null==t?void 0:t.toLocaleString())||0})]},a)})})]}),(0,s.jsxs)("div",{className:"border rounded-lg p-4 flex flex-col justify-center items-center",children:[(0,s.jsx)("h3",{className:"text-lg font-medium mb-4",children:"Avg Transitions / Device"}),(0,s.jsx)("span",{className:"text-4xl font-bold",children:n.toFixed(1)})]})]})})]})},W=e=>{let{title:a,data:t,loading:r}=e;return r?(0,s.jsx)(S,{message:"Loading ".concat(a.toLowerCase()," data...")}):(0,s.jsxs)(i.Zp,{children:[(0,s.jsx)(i.aR,{children:(0,s.jsx)(i.ZB,{children:a})}),(0,s.jsx)(i.Wu,{children:t?(0,s.jsx)("p",{className:"text-lg",children:t}):(0,s.jsx)("p",{className:"text-muted-foreground",children:"No data available"})})]})},z=e=>{let{title:a,subtitle:t,data:r,loading:n}=e;return n?(0,s.jsx)(S,{message:"Loading ".concat(a.toLowerCase()," data...")}):(0,s.jsxs)(i.Zp,{children:[(0,s.jsxs)(i.aR,{children:[(0,s.jsx)(i.ZB,{children:a}),(0,s.jsx)(i.BT,{children:t})]}),(0,s.jsx)(i.Wu,{children:r&&r.length>0?(0,s.jsx)("div",{className:"space-y-2",children:r.map((e,a)=>(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsxs)("span",{children:[e.device,":"]}),(0,s.jsx)("span",{className:"font-medium",children:(e.value,e.value)})]},a))}):(0,s.jsx)("p",{className:"text-muted-foreground",children:"No device data available"})})]})},K=e=>{let{data:a,loading:t}=e;if(t)return(0,s.jsx)(S,{message:"Loading transitions data..."});let r=[];return(a&&a.links&&Array.isArray(a.links)&&(r=a.links.slice(0,10).map(e=>({name:"".concat(e.source," → ").concat(e.target),value:e.value})).sort((e,a)=>a.value-e.value)),r&&0!==r.length)?(0,s.jsx)("div",{className:"h-[400px]",children:(0,s.jsx)(o.u,{width:"100%",height:"100%",children:(0,s.jsxs)(d.E,{data:r,layout:"vertical",margin:{top:5,right:30,left:100,bottom:5},children:[(0,s.jsx)(c.d,{strokeDasharray:"3 3",horizontal:!0,vertical:!1}),(0,s.jsx)(m.W,{type:"number"}),(0,s.jsx)(x.h,{dataKey:"name",type:"category",width:100,tick:{fontSize:11}}),(0,s.jsx)(u.m,{formatter:e=>[Number(e).toLocaleString(),"Count"]}),(0,s.jsx)(h.y,{dataKey:"value",fill:"#4CAF50"})]})})}):(0,s.jsx)("div",{className:"flex justify-center items-center h-[400px]",children:(0,s.jsx)("p",{className:"text-muted-foreground",children:"No transition data available"})})},O=e=>{let{data:a,loading:t}=e;if(t)return(0,s.jsx)(S,{message:"Loading device anomalies data..."});let r=a||[];return(0,s.jsxs)(i.Zp,{className:"col-span-full",children:[(0,s.jsxs)(i.aR,{children:[(0,s.jsx)(i.ZB,{children:"Device Anomalies Summary"}),(0,s.jsx)(i.BT,{children:"Sample of devices with potential issues"})]}),(0,s.jsx)(i.Wu,{children:r.length>0?(0,s.jsx)("div",{className:"overflow-x-auto",children:(0,s.jsxs)("table",{className:"min-w-full divide-y divide-border",children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{className:"py-3 px-4 text-left text-sm font-medium",children:"DSN"}),(0,s.jsx)("th",{className:"py-3 px-4 text-left text-sm font-medium",children:"Type"}),(0,s.jsx)("th",{className:"py-3 px-4 text-left text-sm font-medium",children:"Description"}),(0,s.jsx)("th",{className:"py-3 px-4 text-left text-sm font-medium",children:"Severity"})]})}),(0,s.jsx)("tbody",{className:"divide-y divide-border",children:r.map((e,a)=>(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{className:"py-2 px-4 text-sm",children:e.dsn}),(0,s.jsx)("td",{className:"py-2 px-4 text-sm",children:(0,s.jsx)(l.E,{variant:"outline",className:"bg-red-100 text-red-800 border-red-200",children:e.type})}),(0,s.jsx)("td",{className:"py-2 px-4 text-sm",children:e.description}),(0,s.jsx)("td",{className:"py-2 px-4 text-sm",children:e.severity})]},a))})]})}):(0,s.jsx)("p",{className:"text-center py-4",children:"No device anomalies detected"})})]})},U=e=>{let{data:a,loading:t}=e;if(t)return(0,s.jsx)(S,{message:"Loading daily activity data..."});let r=a||[];return(0,s.jsxs)(i.Zp,{children:[(0,s.jsxs)(i.aR,{children:[(0,s.jsx)(i.ZB,{children:"Daily Activities"}),(0,s.jsx)(i.BT,{children:"Device activity count over time"})]}),(0,s.jsx)(i.Wu,{children:(0,s.jsx)("div",{className:"h-[300px]",children:r.length>0?(0,s.jsx)(o.u,{width:"100%",height:"100%",children:(0,s.jsxs)(N.Q,{data:r,margin:{top:20,right:30,left:20,bottom:5},children:[(0,s.jsx)(c.d,{strokeDasharray:"3 3"}),(0,s.jsx)(m.W,{dataKey:"date"}),(0,s.jsx)(x.h,{}),(0,s.jsx)(u.m,{}),(0,s.jsx)(y.s,{}),(0,s.jsx)(w.G,{type:"monotone",dataKey:"count",fill:"#8884d8",stroke:"#8884d8"})]})}):(0,s.jsx)("div",{className:"flex justify-center items-center h-full",children:(0,s.jsx)("p",{className:"text-muted-foreground",children:"No activity data available"})})})})]})},P=e=>{var a,t;let{data:r,loading:n}=e;return n?(0,s.jsx)(S,{message:"Loading transition heatmap data..."}):r?(0,s.jsxs)(i.Zp,{className:"col-span-full",children:[(0,s.jsxs)(i.aR,{children:[(0,s.jsx)(i.ZB,{children:"State Transition Heatmap"}),(0,s.jsx)(i.BT,{children:"Frequency of transitions between states"})]}),(0,s.jsx)(i.Wu,{children:(0,s.jsx)("div",{className:"overflow-x-auto",children:(0,s.jsxs)("table",{className:"min-w-full border",children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{className:"py-3 px-4 text-left text-sm font-medium border bg-muted",children:"From ↓ | To →"}),null==(a=r.headers)?void 0:a.map((e,a)=>(0,s.jsx)("th",{className:"py-3 px-4 text-left text-sm font-medium border bg-muted",children:e},a))]})}),(0,s.jsx)("tbody",{children:null==(t=r.rows)?void 0:t.map((e,a)=>{var t;return(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{className:"py-2 px-4 text-left text-sm font-medium border bg-muted",children:e.name}),null==(t=e.values)?void 0:t.map((e,a)=>{let t="bg-white";return e>0&&(e>1e4?t="bg-red-100":e>1e3?t="bg-red-50":e>100&&(t="bg-blue-50")),(0,s.jsx)("td",{className:"py-2 px-4 text-sm text-center border ".concat(t),children:e>0?e.toLocaleString():""},a)})]},a)})})]})})})]}):(0,s.jsxs)(i.Zp,{className:"col-span-full",children:[(0,s.jsxs)(i.aR,{children:[(0,s.jsx)(i.ZB,{children:"State Transition Heatmap"}),(0,s.jsx)(i.BT,{children:"No data available"})]}),(0,s.jsx)(i.Wu,{children:(0,s.jsx)("p",{children:"Transition heatmap data could not be loaded"})})]})},M=e=>{let{data:a,loading:t,cohortField:r}=e;if(t)return(0,s.jsx)(S,{message:"Loading cohort analysis data..."});let n=a||[];return(0,s.jsxs)(i.Zp,{className:"col-span-full",children:[(0,s.jsxs)(i.aR,{children:[(0,s.jsx)(i.ZB,{children:"Device Cohort Analysis"}),(0,s.jsx)(i.BT,{children:"Compare journey stats by cohort"})]}),(0,s.jsxs)(i.Wu,{children:[(0,s.jsx)("div",{className:"mb-4",children:(0,s.jsxs)("p",{className:"text-sm mb-2",children:["Cohort Field: ",(0,s.jsx)("span",{className:"font-medium",children:r})]})}),n.length>0?(0,s.jsx)("div",{className:"overflow-x-auto",children:(0,s.jsxs)("table",{className:"min-w-full divide-y divide-border",children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{children:[(0,s.jsxs)("th",{className:"py-3 px-4 text-left text-sm font-medium",children:["Cohort (",r,")"]}),(0,s.jsx)("th",{className:"py-3 px-4 text-left text-sm font-medium",children:"Devices"}),(0,s.jsx)("th",{className:"py-3 px-4 text-left text-sm font-medium",children:"Avg Dwell (days)"}),(0,s.jsx)("th",{className:"py-3 px-4 text-left text-sm font-medium",children:"Anomaly Rate"})]})}),(0,s.jsx)("tbody",{className:"divide-y divide-border",children:n.map((e,a)=>{var t,r,i;return(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{className:"py-2 px-4 text-sm",children:e.name||"Unknown"}),(0,s.jsx)("td",{className:"py-2 px-4 text-sm",children:null==(t=e.devices)?void 0:t.toLocaleString()}),(0,s.jsx)("td",{className:"py-2 px-4 text-sm",children:null==(r=e.avgDwell)?void 0:r.toFixed(1)}),(0,s.jsxs)("td",{className:"py-2 px-4 text-sm",children:[(i=100*e.anomalyRate,i.toFixed(1)),"%"]})]},a)})})]})}):(0,s.jsx)("p",{className:"text-center py-4",children:"No cohort data available"})]})]})},I=e=>{let{data:a,loading:t}=e;return t?(0,s.jsx)(S,{message:"Loading bottleneck analysis data..."}):a?(0,s.jsxs)(i.Zp,{className:"col-span-full",children:[(0,s.jsxs)(i.aR,{children:[(0,s.jsx)(i.ZB,{children:"Bottleneck & Throughput"}),(0,s.jsx)(i.BT,{children:"Stage with highest dwell time and device flow over time"})]}),(0,s.jsx)(i.Wu,{children:(0,s.jsxs)("div",{className:"p-6 flex flex-col justify-center items-center h-full",children:[(0,s.jsx)("p",{className:"text-lg font-medium mb-4",children:"Potential Bottleneck Stage: "}),(0,s.jsxs)("p",{className:"text-xl font-bold",children:[a.stage||a.state||"Unknown","(Avg ",a.avgDays||a.duration||0," days)"]})]})})]}):(0,s.jsxs)(i.Zp,{className:"col-span-full",children:[(0,s.jsxs)(i.aR,{children:[(0,s.jsx)(i.ZB,{children:"Bottleneck & Throughput"}),(0,s.jsx)(i.BT,{children:"No data available"})]}),(0,s.jsx)(i.Wu,{children:(0,s.jsx)("p",{children:"Bottleneck analysis could not be loaded"})})]})},q=e=>{let{data:a,loading:t}=e;if(t)return(0,s.jsx)(D,{});console.log("JourneyFunnel received data:",a);let r=[];if(Array.isArray(a)?r=a.map(e=>({name:e.name||e.stage||"",value:e.value||e.count||0})):a&&a.data&&Array.isArray(a.data)?r=a.data.map(e=>({name:e.name||e.stage||"",value:e.value||e.count||0})):(console.error("Unexpected journey funnel data format:",a),r=[]),0===r.length)return(0,s.jsx)("div",{className:"flex justify-center items-center h-[300px]",children:(0,s.jsx)("p",{className:"text-muted-foreground",children:"No journey funnel data available"})});let i=r.filter(e=>e&&"object"==typeof e&&e.name);return 0===i.length?(0,s.jsx)("div",{className:"flex justify-center items-center h-[300px]",children:(0,s.jsx)("p",{className:"text-muted-foreground",children:"Invalid journey funnel data format"})}):(console.log("JourneyFunnel processed data:",i),(0,s.jsx)("div",{className:"h-[300px]",children:(0,s.jsx)(o.u,{width:"100%",height:"100%",children:(0,s.jsxs)(d.E,{data:i,layout:"horizontal",margin:{top:20,right:50,left:20,bottom:5},children:[(0,s.jsx)(c.d,{strokeDasharray:"3 3"}),(0,s.jsx)(m.W,{dataKey:"name",tick:{fontSize:12},interval:0,angle:-45,textAnchor:"end",height:80}),(0,s.jsx)(x.h,{}),(0,s.jsx)(u.m,{formatter:e=>[Number(e).toLocaleString(),"Devices"]}),(0,s.jsx)(h.y,{dataKey:"value",fill:"#6C5CE7",minPointSize:5,label:e=>{let{x:a,y:t,width:r,height:i,value:n}=e;return(0,s.jsx)("text",{x:a+r/2,y:n>0?t+i/2:t-5,fill:n>0?"#fff":"#666",textAnchor:"middle",dominantBaseline:"middle",fontSize:11,children:n.toLocaleString()})}})]})})}))};var $=t(97168),V=t(85339),G=t(53904);let X=async e=>{let a=e.startsWith("/")?e:"/api/analytics/".concat(e);try{if(console.log("Fetching data from ".concat(a,"...")),a.includes("summary")){console.log("Using summary endpoint");let e=await n.tP();return console.log("Summary response:",e.data),e.data}if(a.includes("state-distribution")){console.log("Using state distribution endpoint");let e=await n.G1();return console.log("Distribution response:",e.data),e.data}if(a.includes("state-transitions")){console.log("Using state transitions endpoint");let e=await n.uU();return console.log("Transitions response:",e.data),e.data}else if(a.includes("journey-funnel")){console.log("Using journey funnel endpoint");let e=await n.VG();return console.log("Journey funnel response:",e.data),e.data}else if(a.includes("activity-timeline")){console.log("Using activity timeline endpoint");let e=await n.ls();return console.log("Timeline response:",e.data),e.data}else if(a.includes("state-duration")){console.log("Using state duration endpoint");let e=await n.Kw();return console.log("Duration response:",e.data),e.data}else if(a.includes("transition-heatmap")){console.log("Using transition heatmap endpoint");let e=await n.U1();return console.log("Transition heatmap response:",e.data),e.data}else if(a.includes("device-anomalies")){console.log("Using device anomalies endpoint");let e=await n._1();return console.log("Anomalies response:",e.data),e.data}else{console.log("Using generic endpoint ".concat(e));let a=await n.v3(e);return console.log("Generic response for ".concat(e,":"),a),a}}catch(e){throw e.response?console.error("API error for ".concat(a,":"),{status:e.response.status,data:e.response.data,headers:e.response.headers}):e.request?console.error("No response received for ".concat(a,":"),e.request):console.error("Error setting up request for ".concat(a,":"),e.message),Error(e.message||"Failed to fetch ".concat(a))}},H=e=>{let{message:a,onRetry:t}=e;return(0,s.jsx)("div",{className:"p-4 bg-red-50 border border-red-200 rounded-md my-4",children:(0,s.jsxs)("div",{className:"flex items-start",children:[(0,s.jsx)(V.A,{className:"h-5 w-5 text-red-500 mr-2 mt-0.5"}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("h3",{className:"text-sm font-medium text-red-800",children:"Error loading analytics data"}),(0,s.jsx)("p",{className:"text-sm text-red-700 mt-1",children:a})]}),(0,s.jsxs)($.$,{variant:"outline",size:"sm",className:"ml-4 bg-white hover:bg-red-100",onClick:t,children:[(0,s.jsx)(G.A,{className:"h-4 w-4 mr-1"}),"Retry"]})]})})};function J(){var e,a;let[t,n]=(0,r.useState)(null),[l,o]=(0,r.useState)([]),[d,c]=(0,r.useState)(null),[m,x]=(0,r.useState)([]),[u,h]=(0,r.useState)(null),[g,j]=(0,r.useState)([]),[v,f]=(0,r.useState)(null),[y,p]=(0,r.useState)([]),[b,N]=(0,r.useState)("Vendor"),[w,A]=(0,r.useState)(!0),[D,L]=(0,r.useState)(!0),[V,J]=(0,r.useState)(!0),[Q,Y]=(0,r.useState)(!0),[ee,ea]=(0,r.useState)(!0),[et,es]=(0,r.useState)(!0),[er,ei]=(0,r.useState)(!0),[en,el]=(0,r.useState)([]),[eo,ed]=(0,r.useState)(!1),[ec,em]=(0,r.useState)(""),[ex,eu]=(0,r.useState)(0),[eh,eg]=(0,r.useState)(null),[ej,ev]=(0,r.useState)(!1),ef=async()=>{ed(!1),em("");try{A(!0);try{console.log("Fetching summary data...");let e=await X("summary");console.log("Received summary data:",e),e&&e.totalDevices&&e.totalActivities&&!e.avgActivitiesPerDevice&&(e.avgActivitiesPerDevice=e.totalActivities/e.totalDevices),n(e)}catch(e){console.error("Error loading summary:",e),ed(!0),em("Error loading summary: ".concat(e.message||"Unknown error"))}finally{A(!1)}try{L(!0),console.log("Fetching state distribution data...");let e=await X("state-distribution");console.log("Received state distribution data:",e),o(e||[])}catch(e){console.error("Error loading state distribution:",e)}finally{L(!1)}try{J(!0),console.log("Fetching state transitions data...");let e=await X("state-transitions");if(console.log("Received state transitions data:",e),e&&Array.isArray(e)){let a=new Set,t=[];for(let s of e)if(s.transition&&s.count){let[e,r]=s.transition.split(" → ");e&&r&&(a.add(e),a.add(r),t.push({source:e,target:r,value:s.count}))}else if(s.from&&s.to&&s.count){let e=s.from,r=s.to;a.add(e),a.add(r),t.push({source:e,target:r,value:s.count})}let s={nodes:Array.from(a).map(e=>({id:e})),links:t};console.log("Generated Sankey data:",s),c(s),el(e.slice(0,10))}}catch(e){console.error("Error loading transitions:",e)}finally{J(!1)}try{Y(!0),console.log("Fetching activity timeline data...");let e=await X("activity-timeline");console.log("Received activity timeline data:",e),e&&Array.isArray(e)&&0!==e.length?x(e):(console.log("No timeline data, using generated timeline"),x(ey()))}catch(e){console.error("Error loading timeline:",e),x(ey())}finally{Y(!1)}try{ea(!0),console.log("Fetching anomalies data...");let t=await X("device-anomalies-summary");if(console.log("Received anomalies data:",t),t){var e,a;let s={outlierDevices:t.total_anomalous_devices||0,loopDetected:(null==(e=t.anomaly_counts_by_type)?void 0:e.LOOP_DETECTED)||0,stuckDevices:(null==(a=t.anomaly_counts_by_type)?void 0:a.EXCESSIVE_DWELL)||0};console.log("Formatted anomaly data:",s),h(s),j(t.sample_anomalies||[])}}catch(e){console.error("Error loading anomalies:",e)}finally{ea(!1)}try{es(!0),console.log("Fetching journey funnel data...");let e=await X("journey-funnel");console.log("Received journey funnel data:",e),e&&Array.isArray(e)&&f({data:e.map(e=>({name:e.stage||"",value:e.count||0}))})}catch(e){console.error("Error loading journey funnel:",e)}finally{es(!1)}try{ei(!0),console.log("Fetching state duration data...");let e=await X("state-duration");console.log("Received duration data:",e),p(e||[])}catch(e){console.error("Error loading state duration:",e)}finally{ei(!1)}try{ev(!0),console.log("Fetching transition heatmap data...");let e=await X("transition-heatmap");if(console.log("Received transition heatmap data:",e),e&&e.states&&e.matrix){let a={headers:e.states,rows:e.states.map((a,t)=>({name:a,values:e.matrix[t]||[]}))};console.log("Formatted heatmap data:",a),eg(a)}else if(e){if(console.error("Transition heatmap data is in unexpected format:",e),e.headers&&e.rows)eg(e);else if(Array.isArray(e)){let a=Array.from(new Set(e.flatMap(e=>[e.from,e.to]).filter(Boolean))),t=Array(a.length).fill(0).map(()=>Array(a.length).fill(0));e.forEach(e=>{if(e.from&&e.to&&"number"==typeof e.count){let s=a.indexOf(e.from),r=a.indexOf(e.to);s>=0&&r>=0&&(t[s][r]=e.count)}});let s={headers:a,rows:a.map((e,a)=>({name:e,values:t[a]||[]}))};console.log("Converted array data to heatmap format:",s),eg(s)}}}catch(e){console.error("Error loading transition heatmap:",e);try{console.log("Automatically retrying transition heatmap fetch...");let e=await X("transition-heatmap");if(e&&e.states&&e.matrix){let a={headers:e.states,rows:e.states.map((a,t)=>({name:a,values:e.matrix[t]||[]}))};eg(a)}}catch(e){console.error("Retry also failed:",e)}}finally{ev(!1)}}catch(e){console.error("Error in loadBasicAnalytics:",e),ed(!0),em(e instanceof Error?e.message:"Failed to load analytics data")}},ey=()=>{let e=[],a=new Date("2024-06-01"),t=new Date("2024-12-04");for(let s=new Date(a);s<=t;s.setDate(s.getDate()+1)){let a=s.toISOString().split("T")[0],t=Math.floor(1950*Math.random())+50,r=Math.random()>.95?Math.floor(15e3*Math.random())+3e3:0;e.push({date:a,count:t+r})}return e};(0,r.useEffect)(()=>{ef()},[]);let ep=async()=>{eu(e=>e+1),console.log("Refreshing analytics data (retry #".concat(ex+1,")")),await ef()},eb=async()=>{L(!0);try{console.log("Retrying state distribution data...");let e=await X("state-distribution");o(e||[])}catch(e){console.error("Error retrying state distribution:",e)}finally{L(!1)}},eN=async()=>{J(!0);try{console.log("Retrying state transitions data...");let e=await X("state-transitions");if(e&&Array.isArray(e)){let a=new Set,t=[];for(let s of e)if(s.from&&s.to&&s.count){let e=s.from,r=s.to;a.add(e),a.add(r),t.push({source:e,target:r,value:s.count})}let s={nodes:Array.from(a).map(e=>({id:e})),links:t};c(s);let r=e.slice(0,10).map(e=>({name:"".concat(e.fromName||e.from," → ").concat(e.toName||e.to),value:e.count,highlighted:!1}));el(r)}}catch(e){console.error("Error retrying transitions:",e)}finally{J(!1)}},ew=async()=>{ev(!0);try{console.log("Retrying transition heatmap data...");let e=await X("transition-heatmap");if(e&&e.states&&e.matrix){let a={headers:e.states,rows:e.states.map((a,t)=>({name:a,values:e.matrix[t]||[]}))};console.log("Formatted heatmap data:",a),eg(a)}else if(e){if(console.error("Transition heatmap data is in unexpected format:",e),e.headers&&e.rows)eg(e);else if(Array.isArray(e)){let a=Array.from(new Set(e.flatMap(e=>[e.from,e.to]).filter(Boolean))),t=Array(a.length).fill(0).map(()=>Array(a.length).fill(0));e.forEach(e=>{if(e.from&&e.to&&"number"==typeof e.count){let s=a.indexOf(e.from),r=a.indexOf(e.to);s>=0&&r>=0&&(t[s][r]=e.count)}});let s={headers:a,rows:a.map((e,a)=>({name:e,values:t[a]||[]}))};console.log("Converted array data to heatmap format:",s),eg(s)}}}catch(e){console.error("Error retrying transition heatmap:",e)}finally{ev(!1)}};return(0,s.jsxs)("div",{className:"mb-24 space-y-6",children:[eo&&(0,s.jsx)(H,{message:ec,onRetry:ep}),(0,s.jsx)("div",{className:"grid gap-4 md:grid-cols-3",children:(0,s.jsx)(T,{data:t,loading:w})}),(0,s.jsxs)("div",{className:"grid gap-4 md:grid-cols-3",children:[(0,s.jsxs)(i.Zp,{children:[(0,s.jsxs)(i.aR,{className:"flex flex-row items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(i.ZB,{children:"Daily Activity"}),(0,s.jsx)(i.BT,{children:"Activity volume over time"})]}),!Q&&0===m.length&&(0,s.jsxs)($.$,{variant:"outline",size:"sm",onClick:()=>{Y(!0),X("activity-timeline").then(e=>{e&&Array.isArray(e)&&e.length>0?x(e):x(ey())}).catch(e=>{console.error("Error retrying timeline:",e),x(ey())}).finally(()=>Y(!1))},children:[(0,s.jsx)(G.A,{className:"h-4 w-4 mr-1"}),"Retry"]})]}),(0,s.jsx)(i.Wu,{children:Q?(0,s.jsx)(S,{message:"Loading activity data..."}):(0,s.jsx)(U,{data:m,loading:!1})})]}),(0,s.jsxs)(i.Zp,{children:[(0,s.jsxs)(i.aR,{className:"flex flex-row items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(i.ZB,{children:"State Distribution"}),(0,s.jsx)(i.BT,{children:"Current device states"})]}),!D&&0===l.length&&(0,s.jsxs)($.$,{variant:"outline",size:"sm",onClick:eb,children:[(0,s.jsx)(G.A,{className:"h-4 w-4 mr-1"}),"Retry"]})]}),(0,s.jsx)(i.Wu,{children:D?(0,s.jsx)(S,{message:"Loading state data..."}):(0,s.jsx)(E,{data:l,loading:!1})})]}),(0,s.jsxs)(i.Zp,{children:[(0,s.jsxs)(i.aR,{className:"flex flex-row items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(i.ZB,{children:"Device Anomalies"}),(0,s.jsx)(i.BT,{children:"Unusual device behavior"})]}),!ee&&!u&&(0,s.jsxs)($.$,{variant:"outline",size:"sm",onClick:()=>{ea(!0),X("device-anomalies-summary").then(e=>{if(e){var a,t;h({outlierDevices:e.total_anomalous_devices||0,loopDetected:(null==(a=e.anomaly_counts_by_type)?void 0:a.LOOP_DETECTED)||0,stuckDevices:(null==(t=e.anomaly_counts_by_type)?void 0:t.EXCESSIVE_DWELL)||0}),j(e.sample_anomalies||[])}}).catch(e=>console.error("Error retrying anomalies:",e)).finally(()=>ea(!1))},children:[(0,s.jsx)(G.A,{className:"h-4 w-4 mr-1"}),"Retry"]})]}),(0,s.jsx)(i.Wu,{children:ee?(0,s.jsx)(S,{message:"Loading anomaly data..."}):(0,s.jsx)(C,{data:u,loading:!1})})]})]}),(0,s.jsxs)("div",{className:"grid gap-6 md:grid-cols-12",children:[(0,s.jsxs)(i.Zp,{className:"md:col-span-7",children:[(0,s.jsxs)(i.aR,{className:"flex flex-row items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(i.ZB,{children:"State Transitions"}),(0,s.jsx)(i.BT,{children:"How devices move between states"})]}),!V&&(!d||!d.nodes||0===d.nodes.length)&&(0,s.jsxs)($.$,{variant:"outline",size:"sm",onClick:eN,children:[(0,s.jsx)(G.A,{className:"h-4 w-4 mr-1"}),"Retry"]})]}),(0,s.jsx)(i.Wu,{children:V?(0,s.jsx)(S,{message:"Loading transitions data..."}):d&&d.nodes&&d.nodes.length>0?(0,s.jsx)(K,{data:d,loading:!1}):(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center h-[400px]",children:[(0,s.jsx)("p",{className:"text-sm text-gray-500 mb-3",children:"No transitions data available"}),(0,s.jsxs)($.$,{variant:"outline",onClick:eN,children:[(0,s.jsx)(G.A,{className:"h-4 w-4 mr-1"}),"Retry Loading"]})]})})]}),(0,s.jsxs)(i.Zp,{className:"md:col-span-5",children:[(0,s.jsxs)(i.aR,{className:"flex flex-row items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(i.ZB,{children:"Device Journey Flow"}),(0,s.jsx)(i.BT,{children:"Progression through key states"})]}),!et&&(!v||!v.data||0===v.data.length)&&(0,s.jsxs)($.$,{variant:"outline",size:"sm",onClick:()=>{es(!0),X("journey-funnel").then(e=>{e&&Array.isArray(e)&&f({data:e.map(e=>({name:e.stage||"",value:e.count||0}))})}).catch(e=>console.error("Error retrying journey funnel:",e)).finally(()=>es(!1))},children:[(0,s.jsx)(G.A,{className:"h-4 w-4 mr-1"}),"Retry"]})]}),(0,s.jsx)(i.Wu,{children:et?(0,s.jsx)(S,{message:"Loading journey data..."}):v&&v.data&&v.data.length>0?(0,s.jsx)(q,{data:v.data,loading:!1}):(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center h-[400px]",children:[(0,s.jsx)("p",{className:"text-sm text-gray-500 mb-3",children:"No journey data available"}),(0,s.jsxs)($.$,{variant:"outline",onClick:()=>{es(!0),X("journey-funnel").then(e=>{e&&Array.isArray(e)&&f({data:e.map(e=>({name:e.stage||"",value:e.count||0}))})}).catch(e=>console.error("Error retrying journey funnel:",e)).finally(()=>es(!1))},children:[(0,s.jsx)(G.A,{className:"h-4 w-4 mr-1"}),"Retry Loading"]})]})})]})]}),(0,s.jsxs)("div",{className:"grid gap-6 md:grid-cols-2",children:[(0,s.jsx)(R,{data:l,loading:D}),(0,s.jsx)(B,{data:m,loading:Q})]}),(0,s.jsxs)("div",{className:"grid gap-6 md:grid-cols-2",children:[(0,s.jsx)(Z,{data:y,loading:er}),(0,s.jsx)(F,{data:l,loading:D})]}),(0,s.jsx)("div",{className:"grid gap-6",children:(0,s.jsx)(k,{data:en,loading:V})}),(0,s.jsx)("div",{className:"grid gap-6",children:(0,s.jsxs)(i.Zp,{className:"col-span-full",children:[(0,s.jsxs)(i.aR,{className:"flex flex-row items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(i.ZB,{children:"State Transition Heatmap"}),(0,s.jsx)(i.BT,{children:"Frequency of transitions between states"})]}),!ej&&(!eh||!eh.headers)&&(0,s.jsxs)($.$,{variant:"outline",size:"sm",onClick:ew,children:[(0,s.jsx)(G.A,{className:"h-4 w-4 mr-1"}),"Retry"]})]}),(0,s.jsx)(i.Wu,{children:ej?(0,s.jsx)(S,{message:"Loading transition heatmap data..."}):eh&&eh.headers&&eh.rows?(0,s.jsx)(P,{data:eh,loading:!1}):(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center h-[300px]",children:[(0,s.jsx)("p",{className:"text-sm text-gray-500 mb-3",children:"No transition heatmap data available"}),(0,s.jsxs)($.$,{variant:"outline",onClick:ew,children:[(0,s.jsx)(G.A,{className:"h-4 w-4 mr-1"}),"Retry Loading"]})]})})]})}),(0,s.jsx)("div",{children:(0,s.jsx)(_,{data:{uniqueDevicesPerState:null==l?void 0:l.reduce((e,a)=>(e[a.name]=a.value,e),{}),avgTransitions:.7},loading:D})}),(0,s.jsxs)("div",{className:"grid gap-6 md:grid-cols-2",children:[(0,s.jsx)(W,{title:"Most Common First State",data:(null==l||null==(e=l[0])?void 0:e.name)?"STOCK TRANSFER (".concat(l[0].value,")"):void 0,loading:D}),(0,s.jsx)(W,{title:"Most Common Last State",data:(null==l||null==(a=l[0])?void 0:a.name)?"STOCK TRANSFER (".concat(l[0].value,")"):void 0,loading:D})]}),(0,s.jsxs)("div",{className:"grid gap-6 md:grid-cols-2",children:[(0,s.jsx)(z,{title:"Top Devices by Activity",subtitle:"Devices with most activities",data:[{device:"6Q159707",value:23},{device:"1495078401",value:13},{device:"1495069525",value:13},{device:"6L219242",value:12}],loading:w}),(0,s.jsx)(z,{title:"Top Devices by Longest State",subtitle:"Devices with longest time in a state",data:[{device:"6L706485: STOCK TRANSFER",value:"694 days"},{device:"6L77277: STOCK TRANSFER",value:"664 days"},{device:"60008436: STOCK TRANSFER",value:"664 days"},{device:"60012521: STOCK TRANSFER",value:"664 days"}],loading:w})]}),(0,s.jsx)("div",{children:(0,s.jsx)(O,{data:g,loading:ee})}),(0,s.jsx)("div",{children:(0,s.jsx)(M,{data:[{name:"Unknown",devices:340935,avgDwell:87.5,anomalyRate:.107}],loading:w,cohortField:b})}),(0,s.jsx)("div",{children:(0,s.jsx)(I,{data:{stage:"OUTWARD_MIS",avgDays:114},loading:w})})]})}},26613:(e,a,t)=>{Promise.resolve().then(t.bind(t,25411))},88145:(e,a,t)=>{"use strict";t.d(a,{E:()=>o});var s=t(95155);t(12115);var r=t(99708),i=t(74466),n=t(53999);let l=(0,i.F)("inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",secondary:"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",destructive:"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground"}},defaultVariants:{variant:"default"}});function o(e){let{className:a,variant:t,asChild:i=!1,...o}=e,d=i?r.DX:"span";return(0,s.jsx)(d,{"data-slot":"badge",className:(0,n.cn)(l({variant:t}),a),...o})}},88482:(e,a,t)=>{"use strict";t.d(a,{BT:()=>o,Wu:()=>d,ZB:()=>l,Zp:()=>i,aR:()=>n});var s=t(95155);t(12115);var r=t(53999);function i(e){let{className:a,...t}=e;return(0,s.jsx)("div",{"data-slot":"card",className:(0,r.cn)("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",a),...t})}function n(e){let{className:a,...t}=e;return(0,s.jsx)("div",{"data-slot":"card-header",className:(0,r.cn)("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",a),...t})}function l(e){let{className:a,...t}=e;return(0,s.jsx)("div",{"data-slot":"card-title",className:(0,r.cn)("leading-none font-semibold",a),...t})}function o(e){let{className:a,...t}=e;return(0,s.jsx)("div",{"data-slot":"card-description",className:(0,r.cn)("text-muted-foreground text-sm",a),...t})}function d(e){let{className:a,...t}=e;return(0,s.jsx)("div",{"data-slot":"card-content",className:(0,r.cn)("px-6",a),...t})}},97168:(e,a,t)=>{"use strict";t.d(a,{$:()=>o});var s=t(95155);t(12115);var r=t(99708),i=t(74466),n=t(53999);let l=(0,i.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground shadow-xs hover:bg-primary/90",destructive:"bg-destructive text-white shadow-xs hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground shadow-xs hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9"}},defaultVariants:{variant:"default",size:"default"}});function o(e){let{className:a,variant:t,size:i,asChild:o=!1,...d}=e,c=o?r.DX:"button";return(0,s.jsx)(c,{"data-slot":"button",className:(0,n.cn)(l({variant:t,size:i,className:a})),...d})}}},e=>{var a=a=>e(e.s=a);e.O(0,[598,821,909,416,441,684,358],()=>a(26613)),_N_E=e.O()}]);